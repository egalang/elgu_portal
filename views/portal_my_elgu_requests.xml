<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_my_elgu_requests" name="My eLGU Requests">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs" t-value="[
                ('/my', 'My Account'),
                ('/my/elgu/requests', 'Your Requests')
            ]"/>

            <div class="container my-4">
                <div class="d-flex flex-wrap justify-content-between align-items-center mb-3">
                    <h2 class="mb-0">Your Requests</h2>

                    <div class="dropdown">
                        <a class="btn btn-outline-secondary dropdown-toggle"
                           data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">
                            Sort: <t t-esc="searchbar_sortings.get(sortby, searchbar_sortings['date'])['label']"/>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <t t-foreach="searchbar_sortings.items()" t-as="s">
                                <li>
                                    <a class="dropdown-item"
                                       t-att-href="'/my/elgu/requests?sortby=%s' % s[0]">
                                        <t t-esc="s[1]['label']"/>
                                    </a>
                                </li>
                            </t>
                        </ul>
                    </div>
                </div>

                <t t-if="not requests">
                    <div class="alert alert-info">
                        You donâ€™t have any requests yet.
                    </div>
                </t>

                <t t-if="requests">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>Request No.</th>
                                    <th>Service</th>
                                    <th>Stage</th>
                                    <th class="text-end">Total</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="requests" t-as="r">
                                    <tr>
                                        <td>
                                            <a t-att-href="'/my/elgu/requests/%s' % r.id">
                                                <t t-esc="r.name"/>
                                            </a>
                                        </td>
                                        <td><t t-esc="r.request_type_id.name"/></td>
                                        <td><t t-esc="r.stage_id.name if r.stage_id else ''"/></td>
                                        <td class="text-end"><t t-esc="r.amount_total"/></td>
                                        <td><t t-esc="r.create_date"/></td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <t t-call="website.pager">
                        <t t-set="pager" t-value="pager"/>
                    </t>
                </t>
            </div>
        </t>
    </template>

</odoo>
